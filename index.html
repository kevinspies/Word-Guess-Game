<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <title>Kevin's Word Guess Game!</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <div id="everything">
        <img src="birds.jpg" alt="birds">
        <h1>Press any key to get started!</h1>
        <p id="wins">Wins:</p>
        <p id="losses">Losses:</p>
        <p>Current Word</p>
        <p id="hiddenWord">_ _ _ _</p>
        <p>Number of guesses remaining:</p>
        <p id="remainingGuesses">9</p>
        <p>Letters already guessed</p>
        <p id="guessedLetters"></p>
    </div>
    <embed loop="true" src="sound.wav" hidden="true" type="video/quicktime"></embed>


    <script>

        //note to TA: OVERHAUL IN PROGRESS

        //***console game.word to see what the word is for testing purposes if you want! will help understand the process of the code better too
        var words = ["aviation", "bluebird", "cloud", "dancer", "eagle", "fantasy", "goldcrest", "happy", "inquire"];

        var game = {//game object

            word: "", wordArray: [], hiddenWord: "", hiddenWordArray: [], remainingGuesses: 9, guessedLetters: [], wrongGuesses: [], wrongGuessesString: "", wins: 0, losses: 0,//guessLetters will be hidden from user, they will just see wrongGuesses or really wrongGuessesString

            generateRandomWord: function () {//updates this.word
                this.word = words[Math.floor(Math.random() * 9)];//0 to 8 index
                // return this.word;
            },
            generateWordArray: function () {
                for (var i = 0; i < this.word.length; i++) {
                    this.wordArray[i] = this.word.charAt(i);//gives me a workable array version of the word
                }
            },
            generateHiddenWordArray: function () {//updates this.hiddenWordArray
                for (var i = 0; i < this.word.length; i++) {
                    this.hiddenWordArray[i] = "_";
                }
                //return this.hiddenWordArray;
            },
            updateHiddenStringToUser: function () {//updates hidden word (with spaces) to user/html
                var concatDisplayString = "";
                for (var i = 0; i < this.hiddenWordArray.length; i++) {
                    concatDisplayString += this.hiddenWordArray[i] + " ";//plus a space, now i will display this
                }
                document.querySelector("#hiddenWord").innerHTML = concatDisplayString;
            },
            updateHiddenWordArray: function (guess) {//updates hiddenWordArray with a correct guess
                for (var i = 0; i < this.word.length; i++) {
                    if (guess === this.word.charAt(i)) {
                        this.hiddenWordArray[i] = guess;
                    }
                }
            },
            addGuessedLetter: function (guess) {//array to hold all guessed letters
                this.guessedLetters.push(guess);
            },
            addWrongGuess: function (guess) {//array to hold wrong guesses, which i display to the user as a string now
                this.wrongGuesses.push(guess);
                for (var i = 0; i < wrongGuesses.length; i++) {
                    this.wrongGuessesString += wrongGuesses[i];
                }
                document.querySelector("#guessedLetters").innerHTML = this.wrongGuessesString;
            },
            alreadyGuessed: function (someGuess) {//boolean to tell if I've already guessed a word, checks against guessedLetters[]
                var count = this.guessedLetters.length;
                for (var i = 0; i < count; i++) {
                    console.log("checking if guessed");
                    if (this.guessedLetters[i] === someGuess) {
                        console.log("already guessed!");
                        return true;
                    }
                }
                return false;
            },
            loseOneGuess: function () {
                this.remainingGuesses--;
                document.querySelector("#remainingGuesses").innerHTML = "Remaining guesses: " + this.remainingGuesses;
            },
            updateWins: function () {
                this.wins++;
                document.querySelector("#wins").innerHTML = "Wins: " + this.wins;
            },
            updateLosses: function () {
                this.losses++;
                document.querySelector("#losses").innerHTML = "Losses: " + this.losses;
            },
            resetGame: function () {
                // this.word = words[Math.floor(Math.random() * 10)];
                this.generateRandomWord();
                this.generateWordArray();
                this.generateHiddenWordArray();
                this.updateHiddenStringToUser();
                this.remainingGuesses = 9;
                this.guessedLetters = "";
                this.hiddenWordArray = [];
                this.hiddenWord = "";
                // this.word = ""; BEEEEP this just overrides generate function dummy!
                this.wrongGuesses = [];
            }
        }//end of game object   
        //***********************************************************************************************************************************************************
        //***********************************************************************************************************************************************************

        //start a new game
        game.generateRandomWord();//game's this.word gets updated with a new random word
        var newWord = game.word;//set it to newWord variable don't need
        game.generateWordArray();
        var newWordArray = game.wordArray;//don't need
        game.generateHiddenWordArray();//games this.hiddenWordArray get's updated with the proper number of _'s
        var newHiddenWordArray = game.hiddenWordArray;//don't need
        console.log(newWord);
        console.log(newHiddenWordArray);
        game.updateHiddenStringToUser();
        //listening
        document.onkeyup = function (event) {
            console.log("key pressed!");
            var userGuess = event.key;
            //i want to add the guess to guessedLetters array, but only if it is a unique guess
            //while (game.remainingGuesses > 0) {//will make this a while loop once i figure out why it crashes the game
            //while remainingGuesses >0
            if (!game.alreadyGuessed(userGuess)) {//if not already guessed
                game.addGuessedLetter(userGuess);//pushes new unique guess to guessedLetters array
                console.log("added " + userGuess + " to guessed list!");

                for (var i = 0; i < game.word.length; i++) {//run through game word, if guess matches at any index update newHiddenWordArray at that index and display it

                    if (game.wordArray[i] === userGuess) {//correct guess
                        console.log("correct!");//this logic is not being reached!!!?
                        game.hiddenWordArray[i] = userGuess;
                        //*******************************UPDATE THEIR PROGRESS HERE***************************************************
                        game.updateHiddenWordArray(userGuess);
                        game.updateHiddenStringToUser();
                    }

                }
                if (userGuess !== game.wordArray[i]) {//incorrect guess
                    console.log("incorrect guess");
                    game.addWrongGuess(userGuess);//adds incorrect userGuess to wrongGuesses
                    game.loseOneGuess();//coulda done these in one method, whatever!
                }

                if (game.remainingGuesses === 0 && game.hiddenWordArray.includes('_')) {//loss condition
                    game.updateLosses();
                    game.resetGame();
                    console.log("loss detected!");
                    //start a new game
                    game.generateRandomWord();//game's this.word gets updated with a new random word
                    var newWord = game.word;//set it to newWord variable
                    game.generateWordArray();
                    var newWordArray = game.generateWordArray();
                    game.generateHiddenWordArray();//games this.hiddenWordArray get's updated with the proper number of _'s
                    var newHiddenWordArray = game.hiddenWordArray;
                    console.log(newWord);
                    console.log(newHiddenWordArray);
                    game.updateHiddenStringToUser();
                }
                else if (!game.hiddenWordArray.includes('_')) {//win condition
                    console.log("win detected!");
                    game.updateWins();
                    game.resetGame();
                    //start a new game
                    game.generateRandomWord();//game's this.word gets updated with a new random word
                    var newWord = game.word;//set it to newWord variable
                    game.generateWordArray();
                    var newWordArray = game.generateWordArray();
                    game.generateHiddenWordArray();//games this.hiddenWordArray get's updated with the proper number of _'s
                    var newHiddenWordArray = game.hiddenWordArray;
                    console.log(newWord);
                    console.log(newHiddenWordArray);
                    game.updateHiddenStringToUser();
                }
                //everything should be nested in the logic of ignoring repeat guesses, even winning and losing
            }

        }


        // if (game.remainingGuesses === 0 && game.hiddenWordArray.includes('_')) {//loss condition
        //     console.log("loss detected!");
        //     game.updateLosses();
        //     game.resetGame();
        // }
        // else if (!game.hiddenWordArray.includes('_')) {//win condition
        //     game.updateWins();
        //     game.resetGame();
        // }



    </script>

</body>

</html>